---
title: "Process and Clean - CKL"
format: pdf
editor: visual
---

# Load Raw Data and Packages

```{r}
#| label: load
#| message: false

library(dplyr)
library(tidyverse)

load("/home2/wburr/Shawn_Research/data/raw_data/raw_CKL.rda")
```

# Format Date + Time

```{r}
#| label: format_date

# format CallReceivedDateTime column as date and time
raw_CKL$CallReceivedDateTime <- as.POSIXlt(raw_CKL$CallReceivedDateTime,
                                format = "%Y-%m-%d %H:%M:%S")

# separate call date/time into their own columns
CKL <- raw_CKL |> extract(CallReceivedDateTime, into = c("Call_Date", "Call_Time"), "(\\S+)\\s*(.*)") |>
  
                  # separate the call year, month, and day into separate columns
                  mutate(Call_Year = year(Call_Date),
                         Call_Month = month(Call_Date),
                         Call_Day = day(Call_Date))
```

# Calculate proportion of calls by gender

```{r}
#| label: by_gender

# Count number of calls from each gender
n_CKL <- nrow(CKL)
n_CKL_F <- length(which(CKL$Gender == "F"))
n_CKL_M <- length(which(CKL$Gender == "M"))
n_CKL_X <- length(which(CKL$Gender == "X"))
n_CKL_NA <- length(which(is.na(CKL$Gender)))

# Calculate proportions
prop_CKL_F <- n_CKL_F / n_CKL # 0.4339
prop_CKL_M <- n_CKL_M / n_CKL # 0.5533
prop_CKL_X <- n_CKL_X / n_CKL # 0.0009
prop_CKL_NA <- n_CKL_NA / n_CKL # 0.0119
```

























